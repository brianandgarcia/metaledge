<ips:template parameters="$table, $headers, $rows" />
{{foreach $rows as $row}}
	<li class='ipsDataItem'>
		{{$idField = $row::$databaseColumnId;}}
		<article itemscope itemtype="http://schema.org/Comment" id='elComment_{$row->$idField}' class='ipsComment {{if in_array( 'IPS\Content\Reputation', class_implements( $row ) ) and settings.reputation_highlight and $row->reputation() >= settings.reputation_highlight}}ipsComment_popular{{endif}} ipsComment_parent ipsClearfix ipsClear {{if $row->hidden()}}ipsModerated{{endif}}'>
			
			{{if in_array( 'IPS\Content\Reputation', class_implements( $row ) ) and settings.reputation_highlight and $row->reputation() >= settings.reputation_highlight}}
				<strong class='ipsComment_popularFlag' data-ipsTooltip title='{lang="this_is_a_popular_comment"}'><i class='fa fa-star'></i></strong>
			{{endif}}

			<div id='comment-{$row->$idField}_wrap' class='ipsComment_content ipsType_normal ipsClearfix'>
				{{if $table->canModerate()}}
					<div class='ipsDataItem_modCheck ipsPos_right'>
						<input type="checkbox" name="moderate[{$row->$idField}]" value="1" data-role="moderation" data-actions="{{if $row->canSplit()}}split merge{{endif}} {{if $row->hidden() === -1 AND $row->canUnhide()}}unhide{{elseif $row->hidden() === 1 AND $row->canUnhide()}}approve{{elseif $row->canHide()}}hide{{endif}} {{if $row->canDelete()}}delete{{endif}}">
					</div>
				{{endif}}
				<div class='ipsComment_header'>
					{$row->contentTableHeader()|raw}
				</div>
				
				<div class='ipsPad_half'>
					<div class='ipsAreaBackground_reset ipsPad'>
						{{if \IPS\Request::i()->controller == 'activity'}}
							<div class='ipsPhotoPanel ipsPhotoPanel_mini ipsClearfix'>
								{template="userPhoto" group="global" app="core" params="$row->author(), 'mini'"}
								<div>
									<h3 class='ipsType_reset ipsType_normal'>{$row->author()->link()|raw}</h3>
						{{endif}}
						<p class='ipsComment_meta ipsType_light ipsType_medium ipsType_blendLinks'>
							{$row->dateLine()|raw}
							{{if $row->editLine()}}
								&middot; {$row->editLine()|raw}
							{{endif}}
							{{if $row->hidden()}}
								&middot; {$row->hiddenBlurb()}
							{{endif}}
							{{if $row instanceof \IPS\Content\ReportCenter and !\IPS\Member::loggedIn()->group['gbw_no_report'] and $row->hidden() !== 1 }}
								&middot; <a href='{$row->url('report')}' data-ipsDialog data-ipsDialog-remoteSubmit data-ipsDialog-size='medium' data-ipsDialog-flashMessage='{lang="report_submit_success"}' data-ipsDialog-title="{lang="report_post"}" data-action='reportComment' title='{lang="report_content"}'><span class='ipsResponsive_showPhone ipsResponsive_inline'><i class='fa fa-flag'></i></span><span class='ipsResponsive_hidePhone ipsResponsive_inline'>{lang="report_post"}</span></a>
							{{endif}}
						</p>
						{{if \IPS\Request::i()->controller == 'activity'}}
								</div>
							</div>
						{{endif}}
						<hr class='ipsHr'>
						<div data-role='commentContent' class='ipsType_break ipsType_richText ipsContained' data-controller='core.front.core.lightboxedImages'>
							{{if $row->hidden() === 1 && $row->author()->member_id == \IPS\Member::loggedIn()->member_id}}
								<strong class='ipsType_medium ipsType_warning'><i class='fa fa-info-circle'></i> {lang="comment_awaiting_approval"}</strong>
							{{endif}}
							{$row->content()|raw}
						</div>
						{{if $row->hidden() !== 1 && $row instanceof \IPS\Content\Reputation and settings.reputation_enabled}}
							{template="reputation" group="global" app="core" params="$row"}
						{{endif}}
					</div>
				</div>			
			</div>
		</article>
	</li>
{{endforeach}}